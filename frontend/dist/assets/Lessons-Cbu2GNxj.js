import{d as v,f as N,a as I,c as o,j as s,L as T,H as w,e as L,A as C}from"./index-9enGk7kT.js";import{B as S}from"./BackIcon-Dim3ipap.js";import{h as $}from"./handleImageError-DYzZusFE.js";import{C as y}from"./ContentNotFound-DBiIoHJE.js";import{L as E}from"./LockIcon-C_iR-92p.js";import{T as R}from"./TImerIcon-C9-4XYlx.js";function _({user:t}){const p=v(),{courseId:n}=N(),{data:i,loading:l,error:d}=I(),[a,m]=o.useState([]),[h,u]=o.useState(""),[f,x]=o.useState(""),[r,k]=o.useState([]),g=(t==null?void 0:t.id)||0,b=e=>{fetch("/api/lesson_viewed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lessonId:e.id,userId:g})}).catch(c=>{console.error("Ошибка при отправке события просмотра урока:",c)}),p(`/lessons/${n}/${e.id}/content`)};return o.useEffect(()=>{if(!l&&i){const c=(i.courses||[]).find(j=>String(j.id)===n);c?(u(c.title),x(c.description),k(c.access_time),m(c.lessons)):(console.warn("Курс не найден"),m([]),u(""),x(""))}},[i,l,n]),d?s.jsxs("div",{className:"error",children:["Ошибка: ",d]}):s.jsxs("div",{className:"page-container content",children:[s.jsxs("div",{className:"back-link-wrapper",children:[s.jsxs(T,{to:"/",className:"back-link",children:[s.jsx(S,{}),"Назад"]}),r!=null&&r!==-1&&s.jsx("div",{className:"access-timer",children:s.jsxs("div",{className:"access-timer-count",children:[s.jsx(R,{}),(()=>{const e=Math.ceil(r/24),c=new Intl.PluralRules("ru-RU");return`${e} ${{one:"день",few:"дня",many:"дней",other:"дня"}[c.select(e)]}`})()]})})]}),s.jsxs("div",{className:"welcome",children:[s.jsx(w,{title:h,svg:s.jsx(L,{})}),s.jsx("p",{className:"text-gray-300",children:f})]}),a!=null&&a.length?a==null?void 0:a.map((e,c)=>s.jsxs("div",{className:`lesson-block ${e.blocked?"lesson-block--blocked":""}`,children:[s.jsxs("div",{className:`badge lesson-badge ${e.blocked?"lesson-badge--blocked":""}`,children:["Урок ",c+1]}),s.jsxs("div",{className:`lesson-card ${e.blocked?"lesson-card--blocked":""}`,onClick:()=>!e.blocked&&b(e),children:[s.jsxs("div",{className:"info",children:[s.jsx("img",{src:e.image||"/images/default-event.png",alt:"",onError:$()}),s.jsx("span",{className:e.blocked?"lesson-title--blocked":"",children:e.blocked?"Доступно после прохождения предыдущего урока":e.title})]}),s.jsx("div",{className:"arrow",children:e.blocked?s.jsx(E,{}):s.jsx(C,{})})]})]},e.id)):s.jsx(y,{message:"Уроки не найдены"})]})}export{_ as default};
