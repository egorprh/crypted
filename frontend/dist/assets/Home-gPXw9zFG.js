import{j as e,c as o,r as I,d as M,a as R,b as L,g as A,H,B as d,e as V,A as Z}from"./index-cSVua3Tt.js";import{C as $}from"./ContentNotFound-m0ZVKDGo.js";import{M as w}from"./Modal-TKPQ49Up.js";import{L as N}from"./LockIcon-BRm4CRMs.js";import{L as S}from"./LabelIcon-BvK3JjOy.js";import{T as x}from"./TImerIcon-DzvKiiJp.js";function T(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:12,height:12,fill:"none",children:e.jsx("path",{d:"M2.25 1.875a1.875 1.875 0 1 1 3.75 0 1.875 1.875 0 1 1 3.75 0v.004c0 .053 0 .203-.028.371h1.528A.75.75 0 0 1 12 3v.75a.75.75 0 0 1-.75.75H.75A.75.75 0 0 1 0 3.75V3a.75.75 0 0 1 .75-.75h1.529a2.226 2.226 0 0 1-.029-.37v-.005Zm.801.375H5.25v-.375a1.125 1.125 0 1 0-2.25 0c0 .064.002.205.034.322.004.018.01.036.017.053Zm3.699 0h2.199a.419.419 0 0 0 .017-.053C9 2.08 9 1.94 9 1.875a1.125 1.125 0 0 0-2.25 0v.375Zm4.5 3v5.625A1.125 1.125 0 0 1 10.125 12H6.75V5.25h4.5ZM1.875 12A1.125 1.125 0 0 1 .75 10.875V5.25h4.5V12H1.875Z"})})}function B(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:103,height:103,fill:"none",children:e.jsx("path",{d:"M90.125 92.27V103h-77.25V92.27c0-10.278 8.09-18.625 18.227-19.2l11.814 19.2L51.5 79.395l8.583 12.875 11.815-19.2c10.137.575 18.227 8.926 18.227 19.2ZM29.492 17.282c6.562-6.15 15.154-9.188 24.162-8.63 16.84 1.09 30.038 15.746 30.038 33.363 0 7.596-6.176 13.772-13.772 13.772H59.594c-1.047-3.558-4.3-6.176-8.197-6.176a8.58 8.58 0 0 0-8.584 8.584 8.58 8.58 0 0 0 8.584 8.583 8.535 8.535 0 0 0 5.94-2.408H69.92c12.325 0 22.355-10.03 22.355-22.355C92.27 19.887 75.55 1.467 54.204.09 42.77-.653 31.925 3.23 23.62 11.025c-7.67 7.188-12.278 17.15-12.832 27.604h8.596c.528-8.167 4.069-15.686 10.107-21.347Zm35.35 29.973.228-.047h5.605c2.15 0 4.03-1.58 4.279-3.717a24.23 24.23 0 0 0-.39-7.858c-1.906-8.922-9.146-16.12-18.082-17.956-15.18-3.12-28.578 8.455-28.578 23.093 0 6.305 2.485 12.039 6.524 16.274.476-9.055 7.9-16.274 17.076-16.274 5.42 0 10.193 2.563 13.339 6.485Z"})})}function E(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:103,height:103,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:11,height:11,children:e.jsx("path",{d:"M11 3.67v5.5h-.917V4.26L6.472 6.59a1.784 1.784 0 0 1-1.944 0L0 3.67 4.528.747a1.788 1.788 0 0 1 1.944 0L11 3.67ZM5.5 7.793c-.52 0-1.03-.151-1.467-.434l-2.2-1.418V9.36l.135.134c.043.043 1.079 1.051 3.532 1.051 2.453 0 3.49-1.008 3.532-1.05l.135-.135V5.942l-2.2 1.418a2.701 2.701 0 0 1-1.467.434Z"})})})}function D({children:p,className:a}){const[h,m]=o.useState(!1),n=o.useRef(null);return n.current||(n.current=document.createElement("div")),o.useEffect(()=>{const c=n.current;c.setAttribute("data-blur","true"),a&&(c.className=a);const i=document.body.style.overflow;return document.body.style.overflow="hidden",document.body.appendChild(c),m(!0),()=>{document.body.style.overflow=i,document.body.removeChild(c)}},[]),h?I.createPortal(p,n.current):null}function K(){var g;const p=M(),{data:a,loading:h,error:m,user:n}=R(),{surveyPassed:c}=L(),[i,u]=o.useState(null),[l,r]=o.useState(null),b=(n==null?void 0:n.id)||0,y=a&&a.config||[],_=A(y,"prolong_manager"),C=s=>{fetch("/api/course_viewed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({courseId:s.id,userId:b})}).catch(console.error).finally(()=>{if(s.access_time===0&&s.user_enrolment===0){r({type:"noaccess",course:s});return}if(s.access_time!==-1&&s.user_enrolment===0){const t=Math.ceil(s.access_time/24);r({type:"limited",course:s,days:t});return}})},j=s=>{s.direct_link?window.open(s.direct_link,"_blank"):p(`/lessons/${s.id}`)},k=s=>{const t={popup_title:"Бесплатная консультация с аналитиком",popup_desc:"После полного прохождения курса, вам будет доступен созвон с аналитиком, для определения вашей торговой системы."};u({title:s.popup_title||t.popup_title,desc:s.popup_desc||t.popup_desc})},v=()=>{u(null)},P=s=>({1:e.jsx("div",{className:"badge-level badge-level-base",children:"Базовый"}),2:e.jsx("div",{className:"badge-level badge-level-middle",children:"Средний"}),3:e.jsx("div",{className:"badge-level badge-level-pro",children:"Профи"})})[s]||s;return m?e.jsxs("div",{className:"error",children:["Ошибка: ",m]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"courses-wrapper content main-content",children:[e.jsx(H,{}),e.jsxs("section",{className:"courses",children:[(a==null?void 0:a.enter_survey)&&!c&&e.jsxs(D,{className:"enter-survey-portal",children:[e.jsxs("div",{className:"card white-header-card survey-banner",onClick:()=>p("/lessons/enter-survey"),children:[e.jsx("div",{className:"card-header",children:e.jsx("img",{src:"/images/logo-primary.png",alt:"Course",className:"logo"})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"d-flex card-title-wrapper",children:e.jsx("p",{className:"card-title",children:"Входное тестирование"})}),e.jsx("p",{className:"text-gray-300 card-text",children:"Пройдите небольшой тест, чтобы получить доступ к платформе. Это займет не более 30 секунд."}),e.jsx("div",{className:"card-footer",children:e.jsx(d,{type:"btn-white btn-full-width btn-flex btn-p12",text:"Начать",hasArrow:!0})})]})]}),e.jsx(N,{})]}),h?e.jsx("div",{className:"loading",children:"Загрузка курсов..."}):(g=a==null?void 0:a.courses)!=null&&g.length?a.courses.map(s=>e.jsxs("div",{className:"course-card",children:[e.jsxs("div",{className:"course-header",children:[e.jsx("img",{src:s.image||"/images/default-event.png",alt:"Course",className:"course-header-img"}),e.jsx("div",{className:"course-header-overlay",children:e.jsxs("div",{className:"badges",children:[s.access_time!==0&&s.lesson_count>0&&e.jsxs("div",{className:"d-flex",children:[e.jsx("div",{className:"icon-wrapper accent",children:s.lesson_count}),(()=>{const t=new Intl.PluralRules("ru-RU");return{one:"Видеоурок",few:"Видеоурока",many:"Видеоуроков",other:"Видеоурока"}[t.select(s.lesson_count)]})()]}),s.access_time!==0&&s.has_home_work&&e.jsxs("div",{className:"d-flex",children:[e.jsx("div",{className:"hw-icon icon-wrapper accent",children:e.jsx(E,{})}),"Домашние задания"]})]})}),s.access_time===0&&e.jsxs("div",{className:"course-header-overlay-locked",children:[e.jsx(N,{}),e.jsx("h3",{children:"Доступ к курсу закрыт"})]}),s.level&&e.jsx("div",{className:"badge-levels",children:P(s.level)})]}),e.jsxs("div",{className:"course-body",children:[e.jsxs("div",{className:"d-flex course-title-wrapper card-title-wrapper",children:[e.jsx("p",{className:"course-title",children:s.title}),s.access_time===-1||s.user_enrolment===0?e.jsxs("div",{className:"tag",children:[(s.newprice||s.oldprice)&&e.jsx("div",{className:"icon-wrapper accent",children:e.jsx(S,{})}),s.oldprice&&e.jsx("span",{className:"old-price",children:s.oldprice}),s.newprice&&e.jsx("span",{className:"new-price",children:s.newprice})]}):s.access_time!==void 0&&s.access_time!==null&&s.access_time!==-1&&e.jsx("div",{className:"access-timer",children:e.jsxs("div",{className:"access-timer-count",children:[e.jsx(x,{}),(()=>{const t=Math.ceil(s.access_time/24),f=new Intl.PluralRules("ru-RU");return`${t} ${{one:"день",few:"дня",many:"дней",other:"дня"}[f.select(t)]}`})()]})})]}),e.jsx("div",{className:"course-description text-gray-300",children:s.description}),e.jsxs("div",{className:"course-footer",children:[s.has_popup&&e.jsxs("div",{className:"btn icon gift-btn",onClick:t=>{t.stopPropagation(),k(s)},children:[e.jsx("div",{className:"gift-icon-wrapper",children:e.jsx(T,{})}),"Подарок от dept."]}),e.jsxs("button",{className:`start-btn btn ${s.access_time===0?"btn-danger":"btn-white"}`,onClick:()=>C(s),children:[e.jsx("span",{className:`icon-wrapper ${s.access_time===0&&"danger"}`,children:e.jsx(V,{})}),s.access_time===0?"Продлить курс":s.user_enrolment===0?"Начать курс":"Продолжить",e.jsx(Z,{})]})]})]}),e.jsx("hr",{})]},s.id)):e.jsx($,{message:"Курсы не найдены"})]})]}),i&&e.jsx(w,{className:"gift-modal",onClose:v,children:e.jsxs("div",{className:"popup-content",children:[e.jsx("div",{className:"popup-image",children:e.jsx(B,{})}),e.jsx("h3",{children:i.title}),e.jsx("p",{className:"text-gray-300",children:i.desc}),e.jsx(d,{onClick:v,type:"btn-accent btn-p9",text:"Понятно"})]})}),l&&e.jsx(w,{className:"access-modal",onClose:()=>{l.type==="limited"&&j(l.course),r(null)},children:e.jsx("div",{className:"popup-content",children:l.type==="noaccess"?e.jsxs(e.Fragment,{children:[e.jsx(x,{}),e.jsxs("h2",{children:["Время прохождения ",e.jsx("span",{className:"text-danger",children:"истекло"})]}),e.jsx("p",{className:"text-gray-300",children:"Вы не успели завершить курс вовремя. Чтобы вернуть доступ к курсу, напишите менеджеру"}),e.jsxs("div",{className:"btn-wrapper",children:[e.jsx(d,{onClick:()=>{r(null)},type:"btn-p9",text:"Закрыть"}),e.jsx(d,{onClick:()=>{r(null),window.open(_,"_blank")},type:"btn-white btn-p9",text:"Написать"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{}),e.jsx("h2",{children:"Время ограничено"}),e.jsxs("p",{className:"text-gray-300",children:["Отведённое время прохождения курса ",(()=>{const s=new Intl.PluralRules("ru-RU"),t={one:"день",few:"дня",many:"дней",other:"дня"};return`${l.days} ${t[s.select(l.days)]}`})(),", после истечения времени — курс будет недоступен"]}),e.jsx("div",{className:"btn-wrapper",children:e.jsx(d,{onClick:()=>{j(l.course),r(null)},type:"btn-accent btn-p9",text:"Понятно"})})]})})})]})}export{K as default};
