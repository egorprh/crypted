# TYPE  DATABASE        USER            ADDRESS                 METHOD

# Локальные подключения (Unix socket) - ТОЛЬКО для специфичных пользователей
local   all             postgres                              scram-sha-256
local   all             deptmaster                            scram-sha-256
local   all             all                                   reject  # Блокировать остальных

# IPv4/IPv6 подключения - только для приложения
host    crypted         deptmaster      172.16.0.0/12          scram-sha-256  # Docker network
host    crypted         deptmaster      10.0.0.0/8             scram-sha-256  # Private networks

# Репликация (если нужно)
host    replication     replicator      192.168.1.0/24         scram-sha-256  # Только с доверенных IP